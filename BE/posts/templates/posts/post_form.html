<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>게시글 작성</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container mt-5" style="max-width: 600px;">
    <h2 class="mb-4 text-center">
        {% if page %}
            "{{ page.name }}" 페이지에 글쓰기
        {% else %}
            게시글 작성
        {% endif %}
    </h2>

    <form method="post" enctype="multipart/form-data"
        action="{% if post %}{% url 'posts:update_post_view' post.id %}{% else %}{% if page %}{% url 'posts:create_post_view' page.id %}{% else %}{% url 'posts:create_post_view' %}{% endif %}{% endif %}">
        {% csrf_token %}

        <div class="mb-3">
            <label for="type" class="form-label">게시글 유형</label>
            <select name="type" id="type" class="form-select" required>
                <option value="">선택하세요</option>
                <option value="promo" {% if post and post.type == "promo" %}selected{% endif %}>홍보</option>
                <option value="review" {% if post and post.type == "review" %}selected{% endif %}>후기</option>
                <option value="tip" {% if post and post.type == "tip" %}selected{% endif %}>꿀TIP</option>
            </select>
        </div>

        <div class="mb-3">
            <label for="content" class="form-label">내용</label>
            <textarea name="content" id="content" class="form-control" rows="5" required>{{ post.content|default:'' }}</textarea>
        </div>

        {% if post and post.image %}
            <div class="mb-3">
                <label class="form-label">현재 이미지</label><br>
                <img src="{{ post.image.url }}" alt="기존 이미지" class="img-fluid mb-2" style="max-height: 200px;">
            </div>
            <div class="form-check mb-3">
                <input class="form-check-input" type="checkbox" name="delete_image" id="delete_image">
                <label class="form-check-label" for="delete_image">
                    기존 이미지 삭제
                </label>
            </div>
        {% endif %}
        <div class="mb-3">
            <label for="image" class="form-label">이미지 첨부 (선택)</label>
            <input type="file" name="image" id="image" class="form-control">
        </div>

        <div class="text-end">
            <button type="submit" class="btn btn-primary">작성 완료</button>
        </div>
    </form>
</div>
</body>
</html>